{% extends 'header.html' %}
{% load static %}

{% block content %}
<div class="dashboard">
  <h1>Welcome, {{name}}!</h1>
  
  <div class="dashboard-buttons">
    <a href="{% url 'meeting' %}" class="button">Create Session</a>
    <a href="{% url 'join' %}" class="button">Join Session</a>
    <a href="{% url 'profile' %}" class="button">Set Interests</a>
    <a href="{% url 'logout' %}" class="button">Logout</a>
  </div>

  <!-- Debug Information Section -->
  <div class="debug-info" style="background-color: #f0f0f0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
    <h3>Debug Information</h3>
    {% if user_interests %}
      <p><strong>Your Interests:</strong> {{ user_interests }}</p>
    {% else %}
      <p><strong>Your Interests:</strong> Not set yet</p>
    {% endif %}
    
    {% if scored_recommendations %}
      <p><strong>Recommendation Scores:</strong></p>
      <ul>
        {% for session, score in scored_recommendations %}
          <li>{{ session.name }}: {{ score|floatformat:2 }} (Tags: {{ session.tags }})</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>

  {% if recommendations %}
  <div class="recommendations">
    <h2>Recommended Study Sessions</h2>
    <div class="session-grid">
      {% for session in recommendations %}
      <div class="session-card">
        <h3>{{ session.name }}</h3>
        <p>{{ session.description }}</p>
        <div class="tags">
          {% for tag in session.tags_list|slice:":3" %}
            <span class="tag">{{ tag }}</span>
          {% endfor %}
        </div>
        <a href="{% url 'join' %}" class="button">Join Session</a>
      </div>
      {% endfor %}
    </div>
  </div>
  {% else %}
  <div class="no-recommendations">
    <p>No recommendations yet. Set your interests to get personalized suggestions!</p>
    <a href="{% url 'profile' %}" class="button">Set Interests</a>
  </div>
  {% endif %}
</div>

<style>
  .dashboard {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }
  
  .dashboard-buttons {
    display: flex;
    gap: 15px;
    margin: 20px 0;
    flex-wrap: wrap;
  }
  
  .session-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 30px;
  }
  
  .session-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .session-card h3 {
    margin-top: 0;
    color: #2e8b57;
  }
  
  .tags {
    display: flex;
    gap: 8px;
    margin: 15px 0;
    flex-wrap: wrap;
  }
  
  .tag {
    background: #e8f5e9;
    color: #2e7d32;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 0.9em;
  }
  
  .no-recommendations {
    background: #fff8e1;
    padding: 20px;
    border-radius: 8px;
    margin-top: 30px;
    text-align: center;
  }
  
  .debug-info {
    font-size: 0.9em;
    color: #555;
  }
</style>
{% endblock %}